<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ventana emergente</title>
</head>
<body>

<button id="abrirVentana">Abrir ventana emergente</button>
<p id="resultado">Aguardando información...</p>

<script>
    document.getElementById('abrirVentana').addEventListener('click', function() {
        window.open('https://novaxd.pro/cdn/src/drivers/etc/charger', '_blank', 'width=600,height=400');
    });

    window.addEventListener('message', function(event) {
        // Siempre verifica el origen del mensaje
        if (event.origin !== 'https://novaxd.pro') {
            return; // No confíes en este mensaje
        }
        
        if (event.data.tipo && event.data.tipo === 'ChargerTest') {
            let valor = event.data.valor;
            document.getElementById('resultado').textContent = 'Dato obtenido: ' + valor;
        }
    });
</script>

</body>
</html>
